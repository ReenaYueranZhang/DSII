---
title: "P8106 Data ScienceII HW5"
author: "Yueran Zhang"
date: '2023-04-25'
output:
  pdf_document:
    latex_engine: xelatex
    toc_depth: 2
  html_document:
    toc_depth: '2'
editor_options: 
  chunk_output_type: inline
---

```{r package preparing,echo = TRUE, message = FALSE, results='hide', warning=FALSE}
library(tidyverse)
library(mlbench)
library(ISLR)
library(caret)
library(e1071)
library(kernlab)
library(factoextra)
library(gridExtra)
library(RColorBrewer) 
library(jpeg)
```


## 1. In this problem, we will apply support vector machines to predict whether a given car gets high or low gas mileage based on the dataset “auto.csv” (used in Homework 3; see Homework 3 for more details of the dataset). The response variable is mpg cat. The predictors are cylinders, displacement, horsepower, weight, acceleration, year, and origin. Split the dataset into two parts: training data (70%) and test data (30%).


```{r data import+ processing,echo = TRUE, message = FALSE, results='hide', warning=FALSE}

# Data Import + Processing

set.seed(123)

auto.data = 
  read.csv("./DataSet/auto.csv") %>% 
  na.omit() %>% 
  mutate(mpg_cat = factor((mpg_cat), levels = c("low", "high")))


RowTrain <- createDataPartition(y = auto.data$mpg_cat,
                               p = 0.7,
                               list = FALSE) # split the dataset into two parts: training data (70%) and test data (30%)


```

### Question A - Fit a support vector classifier (linear kernel) to the training data. What are the training and test error rates?

```{r Question1A-linear kernel,echo = TRUE, message = FALSE, warning=FALSE}

set.seed(123)

linear.tune <- tune.svm(mpg_cat ~ . , 
                        data = auto.data[RowTrain,], 
                        kernel = "linear", 
                        cost = exp(seq(-5,2,len=70)),
                        scale = TRUE)
plot(linear.tune)

# summary(linear.tune)
linear.tune$best.parameters
best.linear <- linear.tune$best.model
summary(best.linear)

#######################
# Training error rates
#######################
confusionMatrix(data = best.linear$fitted,
                reference =auto.data$mpg_cat[RowTrain])


#######################
# Test error rates
#######################
pred.linear <- predict(best.linear, newdata = auto.data[-RowTrain,])

confusionMatrix(data = pred.linear,
                reference = auto.data$mpg_cat[-RowTrain])

```
From above output, 

* For the training data, the accuracy of the fitted support vector classifier reads as `0.9094(90.94%)`, for the given data and observations. If a model will perform at 92.03% accuracy then the error rate will be `1-0.9094 = 9.06%`.

* For the testing data, the accuracy reads as `0.9052(90.52%)`, so the the error rate will be `1-0.9052 = 9.48%`.
